<div class="max-w-5xl mx-auto px-4 sm:px-6 py-6">

  <!-- Header -->
  <div class="mb-6">
    <h1 class="text-xl sm:text-2xl font-semibold text-gray-800">
      Order Details
    </h1>
    <p class="text-xs sm:text-sm text-gray-500 mt-1 break-all">
      Order ID: <span class="font-medium text-gray-700"><%= order.orderId %></span>
    </p>
  </div>

  <% const status = order.orderStatus; %>

  <!-- ORDER SUMMARY -->
  <div class="bg-white rounded-xl border p-4 sm:p-5 mb-6 space-y-1 text-sm">

    <p>
      <span class="text-gray-500">Total Amount:</span>
      <span class="font-semibold text-gray-900">₹<%= order.totalAmount %></span>
    </p>

    <p>
      <span class="text-gray-500">Payment:</span>
      <span class="uppercase font-medium"><%= order.paymentMethod %></span>
      •
      <% if (order.paymentStatus === "paid") { %>
        <span class="text-green-600 font-semibold">Paid</span>
      <% } else if (order.paymentStatus === "failed") { %>
        <span class="text-red-600 font-semibold">Failed</span>
      <% } else { %>
        <span class="text-yellow-600 font-semibold">Pending</span>
      <% } %>
    </p>

    <p>
      <span class="text-gray-500">Order Status:</span>
      <span class="capitalize font-medium">
        <%= status.replace(/_/g, " ") %>
      </span>
    </p>

  </div>

  <!-- ORDER STATUS UPDATE -->
  <div class="bg-white rounded-xl border p-4 sm:p-5 mb-6">
    <h2 class="font-medium text-gray-800 mb-3">
      Update Order Status
    </h2>

    <% if (status === "delivered") { %>
      <p class="text-sm text-gray-500">
        This order has been delivered and can no longer be updated.
      </p>
    <% } else { %>
      <form
        method="POST"
        action="/admin/orders/<%= order._id %>/status"
        class="flex flex-col sm:flex-row gap-3 sm:items-center">

        <select
          name="status"
          class="border rounded-lg px-3 py-2 text-sm w-full sm:w-auto">

          <% ["pending", "shipped", "delivered", "cancelled"].forEach(s => { %>
            <option value="<%= s %>" <%= s === status ? "selected" : "" %>>
              <%= s.replace(/_/g, " ") %>
            </option>
          <% }) %>

        </select>

        <button
          type="submit"
          class="bg-black text-white px-5 py-2 rounded-lg text-sm
                 hover:bg-gray-900 w-full sm:w-auto">
          Update Status
        </button>
      </form>

      <% if (order.paymentMethod === "cod") { %>
        <p class="text-xs text-gray-500 mt-2">
          COD orders are marked as <strong>Paid</strong> automatically when status is set to
          <strong>Delivered</strong>.
        </p>
      <% } %>
    <% } %>
  </div>

  <!-- ORDER ITEMS -->
  <div class="bg-white rounded-xl border p-4 sm:p-5 mb-6">
    <h2 class="font-medium text-gray-800 mb-4">
      Items
    </h2>

    <div class="divide-y">
      <% order.items.forEach(item => { %>
        <div class="flex justify-between items-start py-3 text-sm">
          <div>
            <p class="font-medium text-gray-800">
              <%= item.title %>
            </p>
            <p class="text-xs text-gray-500">
              Qty: <%= item.quantity %>
              <% if (item.variant && item.variant.size) { %>
                • Size: <%= item.variant.size %>
              <% } %>
            </p>
          </div>

          <div class="font-semibold text-gray-900 whitespace-nowrap">
            ₹<%= item.price * item.quantity %>
          </div>
        </div>
      <% }) %>
    </div>
  </div>

  <!-- SHIPPING ADDRESS -->
  <div class="bg-white rounded-xl border p-4 sm:p-5">
    <h2 class="font-medium text-gray-800 mb-3">
      Shipping Address
    </h2>

    <p class="text-sm leading-relaxed text-gray-700">
      <%= order.address.name %><br>
      <%= order.address.line1 %><br>
      <%= order.address.city %>, <%= order.address.state %><br>
      <%= order.address.pincode %><br>
      Phone: <%= order.address.phone %>
    </p>
  </div>

</div>
